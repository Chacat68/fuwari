---
import ArchivePanel from "@components/ArchivePanel.svelte";
import HeatmapChart from "@components/HeatmapChart.svelte";
import I18nKey from "@i18n/i18nKey";
import { i18n } from "@i18n/translation";
import MainGridLayout from "@layouts/MainGridLayout.astro";
import { siteConfig } from "../config";
import {
	getAllPosts,
	getAllPostsCount,
	getSortedPosts,
} from "../utils/content-utils";

// 优化：只获取必要的文章数据，减少页面大小
const sortedPosts = await getSortedPosts();
const totalPostsCount = await getAllPostsCount();
// 对于热力图，我们只需要基本的文章信息，不需要完整内容
const allPosts = await getAllPosts();

// Archive页面SEO信息
const archiveTitle = `文章归档 - ${siteConfig.title}`;
const archiveDescription = `浏览所有${totalPostsCount}篇文章的归档，按时间和热力图展示内容创作历程`;
const archiveKeywords = [
	"文章归档",
	"博客归档",
	"时间线",
	"热力图",
	"内容创作",
];
---

<MainGridLayout 
	title={archiveTitle}
	description={archiveDescription}
	image={siteConfig.banner?.src}
	keywords={archiveKeywords}
>
    <h1 class="text-2xl font-bold text-black/90 dark:text-white/90 mb-6 transition-colors duration-200">文章归档</h1>
    <!-- 优化：使用懒加载减少初始页面大小 -->
    <HeatmapChart sortedPosts={sortedPosts} totalPostsCount={totalPostsCount} allPosts={allPosts} client:visible></HeatmapChart>
    <ArchivePanel sortedPosts={sortedPosts} client:visible></ArchivePanel>
</MainGridLayout>

