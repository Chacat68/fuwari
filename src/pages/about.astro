---

import { getCollection, getEntry, render } from "astro:content";
import Markdown from "../components/misc/Markdown.astro"; // ä½¿ç”¨é€šç”¨ Markdown ç»„ä»¶ï¼Œåº”ç”¨ custom-md çš„æ’ç‰ˆæ ·å¼
import MBTIOverview from "../components/misc/MBTIOverview.astro";
import { profileConfig, siteConfig } from "../config";
import MainGridLayout from "../layouts/MainGridLayout.astro";

const aboutPost = await getEntry("spec", "about");
const allPosts = await getCollection("posts", (p) => !p.data.draft);

if (!aboutPost) {
	throw new Error("About page content not found");
}

const { Content } = await render(aboutPost);

// Abouté¡µé¢SEOä¿¡æ¯
const aboutTitle = aboutPost.data.title
	? `${aboutPost.data.title} - ${siteConfig.title}`
	: `å…³äºæˆ‘ - ${siteConfig.title}`;
const aboutDescription =
	aboutPost.data.description ||
	"äº†è§£æ›´å¤šå…³äºæŸ¥çŒ«CHACATçš„ä¿¡æ¯ï¼Œæ¸¸æˆå¼€å‘è€…ã€å†…å®¹åˆ›ä½œè€…ã€æ‰‹æœºæ‘„å½±å¸ˆ";
const aboutKeywords = [
	"å…³äº",
	"ä¸ªäººç®€ä»‹",
	"æ¸¸æˆå¼€å‘",
	"å†…å®¹åˆ›ä½œ",
	"æ‘„å½±",
	"æŸ¥çŒ«",
	"CHACAT",
];

// å¤´åƒï¼šä» about frontmatter è¯»å–ï¼Œå¯é€‰ï¼›è‹¥æœªè®¾ç½®åˆ™é€€å›ç«™ç‚¹ logo
type AboutFrontmatter = { avatar?: string; avatarAlt?: string };
const fm = aboutPost.data as AboutFrontmatter;
const avatarSrc = fm.avatar ?? profileConfig.avatar;
const avatarAlt = fm.avatarAlt ?? "ä¸ªäººå¤´åƒ";

// ç»Ÿè®¡å…¨ç«™æ ‡ç­¾ï¼ŒæŒ‰å‡ºç°æ¬¡æ•°é™åºå–å‰ 8 ä¸ª
const tagCountMap = new Map<string, number>();
for (const p of allPosts) {
	for (const t of p.data.tags || []) {
		const key = t.trim();
		if (!key) continue;
		tagCountMap.set(key, (tagCountMap.get(key) || 0) + 1);
	}
}
const topTags = Array.from(tagCountMap.entries())
	.sort((a, b) => b[1] - a[1])
	.slice(0, 8)
	.map(([name]) => name);
---

<MainGridLayout 
	title={aboutTitle} 
	description={aboutDescription}
	image={siteConfig.banner?.src}
	keywords={aboutKeywords}
>
    <div class="flex w-full rounded-[var(--radius-large)] overflow-hidden relative mb-4 md:mb-8">
        <div id="about-container" class="card-base z-10 px-6 md:px-10 pt-8 pb-8 relative w-full">
            <!-- å¤´åƒä¸ä¸ªäººåå­—å±•ç¤ºï¼šåœ¨æ ‡ç­¾ä¸Šæ–¹æ˜¾ç¤ºä½œè€…å§“å -->
            <div class="mb-3 flex items-center justify-center">
                <img src={avatarSrc} alt={avatarAlt} loading="lazy" decoding="async"
                     class="h-24 w-24 md:h-28 md:w-28 rounded-full ring-1 ring-white/20 shadow-sm object-cover" />
            </div>
            <div class="mb-3 text-center">
                <h2 class="text-lg md:text-xl font-semibold tracking-wide text-[#6E92C9] dark:text-[#86A3D5]">æŸ¥çŒ«CHACAT</h2> <!-- å°†å…³äºé¡µæ ‡é¢˜å­—ä½“ä» text-xl/md:text-2xl ä¸‹è°ƒä¸º text-lg/md:text-xlï¼Œå¹¶é‡‡ç”¨å›¾1ç›¸è¿‘çš„è“è‰²æ ‡é¢˜é£æ ¼ -->
            </div>
            <!-- è§’è‰²æ ‡ç­¾å±•ç¤ºï¼ˆç¾åŒ–ï¼‰ï¼šä½¿ç”¨èƒ¶å›Šå¾½ç« é£æ ¼ï¼Œé€‚é…æ˜æš—ä¸»é¢˜å˜é‡ -->
            <div class="mb-3 flex flex-wrap items-center justify-center gap-2">
                <!-- å•ä¸ªå¾½ç« ï¼šæ¸¸æˆå¼€å‘è€…ï¼ˆå‚è€ƒå›¾1çš„èƒ¶å›Š+æè¾¹é£æ ¼ï¼‰ -->
                <span class="inline-flex items-center gap-1 rounded-full px-3 py-1 text-xs font-medium text-[#86A3D5] dark:text-[#9DB5E3] bg-white/5 dark:bg-white/5 border border-white/10 hover:border-white/20 transition-colors">
                    <span>ğŸ®</span>
                    <span>æ¸¸æˆå¼€å‘è€…</span>
                </span>
                <!-- å•ä¸ªå¾½ç« ï¼šå†…å®¹åˆ›ä½œè€… -->
                <span class="inline-flex items-center gap-1 rounded-full px-3 py-1 text-xs font-medium text-[#86A3D5] dark:text-[#9DB5E3] bg-white/5 dark:bg-white/5 border border-white/10 hover:border-white/20 transition-colors">
                    <span>âœï¸</span>
                    <span>å†…å®¹åˆ›ä½œè€…</span>
                </span>
                <!-- å•ä¸ªå¾½ç« ï¼šæ‰‹æœºæ‘„å½±å¸ˆ -->
                <span class="inline-flex items-center gap-1 rounded-full px-3 py-1 text-xs font-medium text-[#86A3D5] dark:text-[#9DB5E3] bg-white/5 dark:bg-white/5 border border-white/10 hover:border-white/20 transition-colors">
                    <span>ğŸ“±</span>
                    <span>æ‰‹æœºæ‘„å½±å¸ˆ</span>
                </span>
            </div>

            <!-- å¤´åƒä¸¤ä¾§ï¼šçƒ­é—¨æ ‡ç­¾ï¼ˆå‰8ï¼‰ -->
            {topTags.length > 0 && (
            <div class="mb-6 flex flex-wrap items-center justify-center gap-2">
                {topTags.map(tag => (
                    <a href={`/tags/${encodeURIComponent(tag)}/`} class="inline-flex items-center gap-1 rounded-full px-3 py-1 text-xs font-medium text-white/80 bg-white/5 border border-white/10 hover:border-white/20 transition-colors">
                        <span>#</span>
                        <span>{tag}</span>
                    </a>
                ))}
            </div>
            )}
            <!-- ä¸‰ä¸ªä¸»é¢˜å¡ç‰‡ï¼šé˜…è¯» / åˆ›ä½œ / è·‘æ­¥ -->
            <div class="grid grid-cols-3 gap-3 md:gap-6 mb-6">
                <!-- å¡ç‰‡ï¼šé˜…è¯»ï¼ˆçº¯æ–‡å­—å¸ƒå±€ï¼Œè´´è¿‘å›¾1ï¼‰ -->
                <div class="btn-card p-3 md:p-6 rounded-[var(--radius-large)] shadow-md border border-white/15 hover:border-white/25 transition-all duration-300 bg-white/[0.06] backdrop-blur-sm hover:shadow-lg hover:translate-y-[-1px] dark:bg-gray-800/60">
                    <!-- çº¯æ–‡å­—å¸ƒå±€ï¼šç§»é™¤å›¾æ ‡ï¼Œä»…ä¿ç•™æ ‡ç­¾ã€æ ‡é¢˜ä¸æè¿° -->
                    <div class="w-full">
                        <!-- é¡¶éƒ¨å°æ ‡ç­¾ï¼šæ”¹ä¸º sr-onlyï¼Œè§†è§‰éšè—ä½†ä¿ç•™å¯è®¿é—®è¯­ä¹‰ -->
                        <div class="sr-only">æ‰€çˆ±</div> <!-- é˜…è¯»å¡ç‰‡å°æ ‡ç­¾ï¼šè¯»å±å¯è§ï¼Œè§†è§‰éšè— -->
                        <!-- å¤§æ ‡é¢˜ï¼šåŠ ç²—ã€ç´§è‡´è¡Œè·ã€çº¯ç™½è‰²ï¼›ä¸å›¾1ä¸€è‡´ -->
                        <h3 class="text-base md:text-2xl font-black leading-tight tracking-tight text-gray-900 dark:text-white">é˜…è¯»</h3> <!-- çª„å±ç¼©å°ä¸º text-baseï¼›æµ…è‰²/æ·±è‰²ä¸»é¢˜è‡ªé€‚åº”é¢œè‰² -->
                        <!-- æè¿°æ–‡æ¡ˆï¼šæ–¹æ¡ˆB -->
                        <p class="mt-1 md:mt-2 text-xs md:text-base leading-6 md:leading-7 text-gray-600 dark:text-white/75">ä¸å¥½ä¹¦ç›¸é‡ï¼Œå’Œè‡ªå·±å¯¹è¯</p> <!-- çª„å±ç¼©å°æè¿°å­—å·ä¸è¡Œé«˜ï¼Œå¹¶è‡ªé€‚åº”ä¸»é¢˜é¢œè‰² -->
                    </div>
                </div>
                <!-- å¡ç‰‡ï¼šåˆ›ä½œï¼ˆçº¯æ–‡å­—å¸ƒå±€ï¼Œè´´è¿‘å›¾1ï¼‰ -->
                <div class="btn-card p-3 md:p-6 rounded-[var(--radius-large)] shadow-md border border-white/15 hover:border-white/25 transition-all duration-300 bg-white/[0.06] backdrop-blur-sm hover:shadow-lg hover:translate-y-[-1px] dark:bg-gray-800/60">
                    <div class="w-full">
                        <!-- é¡¶éƒ¨å°æ ‡ç­¾ï¼šæ”¹ä¸º sr-onlyï¼Œè§†è§‰éšè—ä½†ä¿ç•™å¯è®¿é—®è¯­ä¹‰ -->
                        <div class="sr-only">ä¸“æ³¨</div> <!-- åˆ›ä½œå¡ç‰‡å°æ ‡ç­¾ï¼šè¯»å±å¯è§ï¼Œè§†è§‰éšè— -->
                        <h3 class="text-base md:text-2xl font-black leading-tight tracking-tight text-gray-900 dark:text-white">åˆ›ä½œ</h3> <!-- çª„å±ç¼©å°ä¸º text-baseï¼›æµ…è‰²/æ·±è‰²ä¸»é¢˜è‡ªé€‚åº”é¢œè‰² -->
                        <!-- æè¿°æ–‡æ¡ˆï¼šæ–¹æ¡ˆB -->
                        <p class="mt-1 md:mt-2 text-xs md:text-base leading-6 md:leading-7 text-gray-600 dark:text-white/75">æŠŠçµæ„Ÿè½åœ°æˆä½œå“</p> <!-- çª„å±ç¼©å°æè¿°å­—å·ä¸è¡Œé«˜ï¼Œå¹¶è‡ªé€‚åº”ä¸»é¢˜é¢œè‰² -->
                    </div>
                </div>
                <!-- å¡ç‰‡ï¼šè·‘æ­¥ï¼ˆçº¯æ–‡å­—å¸ƒå±€ï¼Œè´´è¿‘å›¾1ï¼‰ -->
                <div class="btn-card p-3 md:p-6 rounded-[var(--radius-large)] shadow-md border border-white/15 hover:border-white/25 transition-all duration-300 bg-white/[0.06] backdrop-blur-sm hover:shadow-lg hover:translate-y-[-1px] dark:bg-gray-800/60">
                    <div class="w-full">
                        <!-- é¡¶éƒ¨å°æ ‡ç­¾ï¼šæ”¹ä¸º sr-onlyï¼Œè§†è§‰éšè—ä½†ä¿ç•™å¯è®¿é—®è¯­ä¹‰ -->
                        <div class="sr-only">æ—¥å¸¸</div> <!-- è·‘æ­¥å¡ç‰‡å°æ ‡ç­¾ï¼šè¯»å±å¯è§ï¼Œè§†è§‰éšè— -->
                        <h3 class="text-base md:text-2xl font-black leading-tight tracking-tight text-gray-900 dark:text-white">è·‘æ­¥</h3> <!-- çª„å±ç¼©å°ä¸º text-baseï¼›æµ…è‰²/æ·±è‰²ä¸»é¢˜è‡ªé€‚åº”é¢œè‰² -->
                        <!-- æè¿°æ–‡æ¡ˆï¼šæ–¹æ¡ˆB -->
                        <p class="mt-1 md:mt-2 text-xs md:text-base leading-6 md:leading-7 text-gray-600 dark:text-white/75">ç”¨è„šæ­¥ä¸ˆé‡æ—¥å¸¸</p> <!-- çª„å±ç¼©å°æè¿°å­—å·ä¸è¡Œé«˜ï¼Œå¹¶è‡ªé€‚åº”ä¸»é¢˜é¢œè‰² -->
                    </div>
                </div>
            </div>
            <!-- MBTI æ¦‚è§ˆæ¡ -->
            <div class="mb-6">
                <MBTIOverview
                    typeBadge="INTJ-A"
                    bars={[
                        { leftLabel: 'INTROVERTED', rightLabel: 'EXTRAVERTED', leftPercent: 57, rightPercent: 43, barColor: 'from-sky-300 to-sky-500' },
                        { leftLabel: 'INTUITIVE', rightLabel: 'OBSERVANT', leftPercent: 68, rightPercent: 32, barColor: 'from-amber-300 to-amber-500' },
                        { leftLabel: 'THINKING', rightLabel: 'FEELING', leftPercent: 66, rightPercent: 34, barColor: 'from-emerald-300 to-emerald-500' },
                        { leftLabel: 'JUDGING', rightLabel: 'PROSPECTING', leftPercent: 53, rightPercent: 47, barColor: 'from-violet-300 to-violet-500' },
                        { leftLabel: 'ASSERTIVE', rightLabel: 'TURBULENT', leftPercent: 68, rightPercent: 32, barColor: 'from-rose-300 to-rose-500' },
                    ]}
                />
            </div>
            <!-- åŸæ­£æ–‡å†…å®¹ï¼šæ›¿æ¢ä¸º Markdown ç»„ä»¶æ¸²æŸ“ï¼Œåº”ç”¨ custom-md çš„æ’ç‰ˆæ ·å¼ -->
            <Markdown class="markdown-content onload-animation prose-headings:scroll-mt-24 prose-img:rounded-xl prose-pre:rounded-lg prose-a:no-underline hover:prose-a:underline w-full">
                <Content />
            </Markdown>
        </div>
    </div>
</MainGridLayout>